<div class="container-fluid p-5" id="admin-background">
    <div class="overflow-hidden mx-5 border border-0 rounded-2 shadow">
        <div class="row g-0">
            <div class="col-2 overflow-hidden">
                <%- include('../partials/sidebarMenu.ejs') %>
            </div>
            <div class="col-10">
                <div class="row g-0">
                    <%- include('../partials/header.ejs') %>
                </div>
                
                <div class="row g-0">
                    <div class="container-fluid bg-white-200 bg-opacity-75 text-center p-4 po-ralative">
                        <p class="fs-5 text-gray-700 text-start" id="pageTitle">Quản lý bệnh nhân</p>
                        <div id="contentArea">
                            <div class="row m-0">
                                <div class="row">
                                    <div class="col-8 text-start border border-0 rounded shadow bg-white">
                                        <% if (patientInfo && patientInfo.appointments && patientInfo.appointments.length > 0) { %>
                                            <p class="fs-5 fw-bold mt-2 text-center">Lịch hẹn</p>
                                            <table class="table table-striped table-bordered">
                                                <thead>
                                                    <tr>
                                                        <th class="text-center">Bác sĩ</th>
                                                        <th class="text-center">Ngày hẹn</th>
                                                        <th class="text-center">Ngày đặt lịch</th>
                                                        <th class="text-center">Tùy chỉnh</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <% patientInfo.appointments.forEach(function(appointment) { %>
                                                        <tr>
                                                            <td class="ps-3"><%= appointment.doctor.user.name %></td>
                                                            <td class="text-end p-2"><%= appointment.appointment_time %></td>
                                                            <td class="text-end p-2"><%= appointment.createdAt %></td>
                                                            <td class="w-25 text-center">
                                                                <a href="/admin/lich-hen/thong-tin/<%= appointment.appointment_id %>" class="text-decoration-none text-secondary" title="Xem" id="appointmentLinkID">
                                                                    <i class="fas fa-eye fs-5 me-2"></i>Xem chi tiết
                                                                </a>
                                                            </td>
                                                        </tr>
                                                    <% }) %>
                                                </tbody>
                                            </table>
                                        <% } else { %>
                                            <p class="fs-2 m-0 text-danger text-center">Không có lịch hẹn</p>
                                        <% } %>
                                    </div>
                                    <div class="col ms-3 ps-2 text-start">
                                        <div class="row mb-2 border border-0 rounded shadow-sm bg-white">
                                            <% if (patientInfo && patientInfo.user) { %>
                                                <p class="fw-bold fs-5 text-center">Thông tin bệnh nhân</p>
                                                <p class="m-0">Mã số bảo hiểm: <%= patientInfo.health_insurance_code %></p>
                                                <p class="m-0">Tuổi: <%= patientInfo.age %> tuổi</p>
                                                <p class="m-0">Giới tính: <%= patientInfo.user.gender %></p>
                                                <p class="m-0">Ngày sinh: <%= patientInfo.user.day_of_birth %></p>
                                                <p class="m-0">Điện thoại: <%= patientInfo.user.phone_number %></p>
                                                <p class="m-0">Địa chỉ: <%= patientInfo.user.address %></p>
                                                <p class="m-0">CMND/CCCD: <%= patientInfo.user.citizen_id_card %></p>
                                            <% } else { %>
                                                <p class="fs-6 m-0">Không có Bệnh nhân</p>
                                            <% } %>
                                        </div>

                                        <div class="row border border-0 rounded shadow-sm bg-white">
                                            <% if (patientInfo) { %>
                                            <a href="/admin/tai-khoan/thong-tin/<%= patientInfo.user.user_id %>" type="button" class="my-2 text-center">
                                                <button class="btn btn-outline-primary w-75">
                                                    <i class="me-2 fa-solid fa-hand-point-right"></i>Thông tin tài khoản
                                                </button>
                                            </a>
                                                <p class="m-0">
                                                    Tài khoản <%= patientInfo.user.user_id %>
                                                    <i class="fas fa-edit fw-light text-cyan-400 ms-2" style="cursor: pointer;" title="Chỉnh sửa thông tin" onclick="editDocInfo()"></i>
                                                </p>
                                                <p class="m-0">Vai trò: <span class="text-blue-400"><%= patientInfo.user.role %></span></p>
                                                <p class="m-0">Giới tính: <%= patientInfo.user.gender %></p>
                                                <p class="m-0">Số điện thoại: <%= patientInfo.user.phone_number %></p>
                                                <p class="m-0">CMND/CCCD: <%= patientInfo.user.citizen_id_card %></p>
                                                <p class="m-0">Ngày sinh: <%= patientInfo.user.day_of_birth %></p>
                                                <p class="m-0">Địa chỉ: <%= patientInfo.user.address %></p>
                                            <% } else { %>
                                                <p class="fs-6 m-0">Không có thông tin</p>
                                            <% } %>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
